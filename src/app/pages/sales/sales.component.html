<app-navbar></app-navbar>
<div class="main" [ngClass]="{'wide-main': isOpen}">
    <app-topbar></app-topbar>
    <div class="container">
        <div class="header">
            <h3>Fecha {{ date | date }}</h3>
        </div>      
        <div class="tables">
            <div class="sales">
                <div class="card-header">
                    <h2>Ventas</h2>
                </div>
                <table>
                    <thead>
                        <tr>
                            <td>Código</td>
                            <td>Descripción</td>
                            <td>Cantidad</td>
                            <td title="Precio unitario">P/U</td>
                            <td>Subtotal</td>
                            <td>Opciones</td>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let item of saleService.items; let i = index" title="{{ item.description }}">
                            <td>{{ item.barcode }}</td>
                            <td>{{ item.description }}</td>
                            <td>{{ item.quantity }}</td>
                            <td>{{ item.price }}</td>
                            <td>$ {{ item.subtotal }}</td>
                            <td>
                                <button (click)="increaseItem(i)" title="Incrementar cantidad"><fa-icon [icon]="icons[0]"></fa-icon></button>
                                <button (click)="removeItem(i)" title="Quitar del listado"><fa-icon [icon]="icons[1]"></fa-icon></button>
                            </td>
                        </tr>                        
                        <tr class="no-events">
                            <td></td>
                            <td></td>
                            <td></td>
                            <td>Total</td>
                            <td>$ {{ saleService.total }}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="products">
                <div class="card-header">
                    <h2>Productos</h2>
                    <form (submit)="searchProducts()">
                        <label>
                            <input type="text" name="term" [(ngModel)]="term" placeholder="Buscar producto">
                            <button type="submit"><fa-icon [icon]="icons[3]"></fa-icon></button>
                        </label>
                    </form>
                </div>
                <table>
                    <thead>
                        <tr>
                            <td>Añadir</td>
                            <td>Descripción</td>
                            <td>Stock</td>
                            <td>Precio</td>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="no-events" *ngIf="productsFound.length === 0"><td colspan="4">{{ message }}</td></tr>
                        <tr *ngFor="let product of productsFound; let i = index" title="{{ product.description }}">
                            <td><button (click)="selectItem(i)" title="Añadir {{ product.description }} al listado"><fa-icon [icon]="icons[2]"></fa-icon></button></td>
                            <td>{{ product.description }}</td>
                            <td>{{ product.quantity }}</td>
                            <td>$ {{ product.price }}</td>
                        </tr>                        
                    </tbody>
                </table>
            </div>
        </div>
        <div class="actions">
            <button (click)="makeSale()">Realizar Venta</button>
        </div>
    </div>
</div>

<app-modal></app-modal>
